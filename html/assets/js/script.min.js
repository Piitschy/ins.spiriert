var direc;document.addEventListener("alpine:init",(()=>{direc=window.directusSDK}));var first=!0;document.addEventListener("alpine:init",(()=>{Alpine.data("count",(()=>({count:0,opend:!1,pending:!0,hasUpdate:!1,decrease(){this.count>0&&(this.count--,this.update())},increase(){this.count++,this.update()},update(){this.pending?this.hasUpdate=!0:(this.pending=!0,this.opend=this.count>0||this.opend,direc.singleton("workload").update({count:this.count,open:this.opend}).then(function(){this.hasUpdate&&(this.hasUpdate=!1,this.pending=!1,this.update()),this.pending=!1}.bind(this)))},doRefresh(){this.pending&&!first||!Alpine.store("login").loggedIn||(first=!1,this.pending=!0,direc.singleton("workload").read().then(function(i){console.log(i),0===i?this.count=0:(this.count=i.count,this.opend=i.open),this.hasUpdate=!1,this.pending=!1}.bind(this)))},init(){this.$nextTick((()=>{this.$watch("opend",((i,n)=>{i!==n&&(console.log(i,n),this.update())})),onLogin=this.doRefresh.bind(this)}))}})))}));var animation=null;function toggleDialog(){document.getElementById("loginDialog").classList.remove("loading"),console.log("toggle"),null==animation||animation.remove("#loginDialog"),animation=anime({targets:["#loginDialog"],translateY:Alpine.store("login").dialog?-500:0,opacity:Alpine.store("login").dialog?0:1,duration:600,easing:"easeOutQuad"}),Alpine.store("login").dialog=!Alpine.store("login").dialog}document.addEventListener("alpine:init",(()=>{animation=anime({targets:["#loginDialog"],translateY:-500,opacity:0,duration:6,easing:"easeOutQuad",complete(){document.getElementById("loginDialog").classList.remove("loading")}}),Alpine.data("login",(()=>({email:"",password:"",loading:!1,fpw:!1,fmail:!1,logout(){direc.auth.logout().then((()=>{Alpine.store("login").loggedIn=!1,Alpine.store("login").user=null}))},login(){this.loading=!0,console.log(this.email),direc.auth.login({email:this.email,password:this.password}).then((()=>{Alpine.store("login").loggedIn=!0,this.loading=!1,onLogin()}))}}))),Alpine.store("login",{user:Alpine.$persist([]).as("login_user"),loggedIn:Alpine.$persist(!1),dialog:!1})})),document.addEventListener("alpine:initialized",(()=>{Alpine.store("login").loggedIn||toggleDialog()}));